<p-toast position="top-right"></p-toast>

<div class="app-shell">
  <div class="halo"></div>

  <div class="frame">
    <p-toolbar class="app-toolbar">
      <div class="toolbar-left">
        <div class="logo">
          <img src="assets/logo.png" alt="Indkøb logo" />
        </div>
        <div class="brand-block">
          <span class="brand">Indkøb</span>
          <span class="muted">Delt indkøbsseddel • Offline-klar</span>
        </div>
      </div>
      <div class="toolbar-right" *ngIf="auth.user$ | async as user; else loggedOutToolbar">
        <p-tag severity="success" icon="pi pi-bolt" value="Live opdateringer"></p-tag>
        <p-tag severity="info" icon="pi pi-cloud-download" value="PWA klar"></p-tag>
        <button pButton type="button" label="Handle" icon="pi pi-shopping-cart" [routerLink]="['/shop']"></button>
        <button pButton type="button" class="p-button-text" icon="pi pi-sign-out" label="Log ud" (click)="logout()"></button>
      </div>
      <ng-template #loggedOutToolbar>
        <div class="toolbar-right">
          <button pButton type="button" label="Login" icon="pi pi-sign-in" [routerLink]="['/login']"></button>
        </div>
      </ng-template>
    </p-toolbar>

    <ng-container *ngIf="auth.user$ | async as user; else loggedOutLayout">
      <div class="layout">
        <nav class="side-nav surface-card">
          <a class="nav-link" [routerLink]="['/list']" routerLinkActive="active">
            <i class="pi pi-list-check"></i>
            <span class="nav-label">Opret liste</span>
          </a>
          <a class="nav-link" [routerLink]="['/shop']" routerLinkActive="active">
            <i class="pi pi-shopping-cart"></i>
            <span class="nav-label">Handle</span>
          </a>
          <a class="nav-link" [routerLink]="['/items']" routerLinkActive="active">
            <i class="pi pi-tag"></i>
            <span class="nav-label">Vare-katalog</span>
          </a>
          <a class="nav-link" *ngIf="user.isAdmin" [routerLink]="['/users']" routerLinkActive="active">
            <i class="pi pi-users"></i>
            <span class="nav-label">Brugere</span>
          </a>
        </nav>

        <div class="content-shell">
          <router-outlet></router-outlet>
        </div>
      </div>
    </ng-container>

    <ng-template #loggedOutLayout>
      <div class="content-shell">
        <router-outlet></router-outlet>
      </div>
    </ng-template>
  </div>
</div>
